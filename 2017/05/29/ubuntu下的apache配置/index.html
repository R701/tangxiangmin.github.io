<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
            <a class="nav_item" href="/test">Test</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">ubuntu下的apache配置</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/5/29 0:32:39</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/Linux" class="hover-highlight">Linux</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>最近域名备案终于下来了，于是打算将博客从之前的虚拟主机迁移到阿里云上面，然后拿着之前在本地用VMware折腾ubuntu的一点经验，开始捣鼓服务器环境。在配置Apache的时候遇见了不少问题，最大的问题在于其目录层次跟windows上面的完全不一样，导致相关配置无从下手的感觉。查了查资料，现在整理一下。</p>
<a id="more"></a>
<p>参考文档：</p>
<ul>
<li><a href="http://blog.csdn.net/jibcy/article/details/8060651" target="_blank" rel="external"> ubuntu apache2下目录结构</a></li>
</ul>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>整个Apache安装在<code>/etc/apache2</code>下面，打开文件夹，我们来对比一下apache在windows和ubuntu下的目录结构的区别。<br>先是在window下的的目录结构：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">|-bin/</div><div class="line">|-cgi-bin/</div><div class="line">|-conf/</div><div class="line">|-error/</div><div class="line">|-extra-modules/</div><div class="line">|-htdocs/</div><div class="line">|-icons/</div><div class="line">|-include/</div><div class="line">|-lib/</div><div class="line">|-logs/</div><div class="line">|-manual/</div><div class="line">|-modules/</div></pre></td></tr></table></figure></p>
<p>下面是在ubuntu下的目录结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">|-conf-available/</div><div class="line">|-conf-enabled/</div><div class="line">|-mods-available/</div><div class="line">|-mods-enabled/</div><div class="line">|-sites-available/</div><div class="line">|-sites-enabled/</div><div class="line">apache2.conf</div><div class="line">ports.conf</div></pre></td></tr></table></figure></p>
<p>通过对比可以发现，二者的结构完全不一样，相比较而言，ubuntu下的目录更加精简。现在我们来弄明白相关文件夹的作用（下面的配置都只是针对于ubuntu 而言的）。</p>
<h2 id="mods"><a href="#mods" class="headerlink" title="mods"></a>mods</h2><p>apache的许多特性都是通过扩展模块来实现的，想要了解具体的模块可以移步阅读<a href="Apache模块介绍">Apache模块介绍</a>。<code>mods</code>文件夹主要用来配置模块（<code>modules</code>）：</p>
<ul>
<li><code>mods-available</code>表示整个服务器可以使用的模块，通常在编译安装包的时候指定</li>
<li><code>mods-enabled</code>表示已经开启的模块</li>
</ul>
<p>在window下如果需要加载对应的模块，需要去<code>httpd.conf</code>中将引入对应模块的注释取消掉，比如为了隐藏url中的index.php，我们需要开启<code>rewrite</code>模块，在<code>httpd.conf</code>中找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#LoadModule rewrite_module modules/mod_rewrite.so</div></pre></td></tr></table></figure></p>
<p>然后取消掉前面的注释<code>#</code>。然而在ubuntu下我们使用的是<code>a2enmod/a2dismod</code>，来管理模块，比如下面命令启用<code>rewrite</code>模块<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo a2enmod rewrite</div></pre></td></tr></table></figure></p>
<p>然后我们就可以在<code>mods-enabled</code>文件夹下发现一个<code>rewrite.load</code>的文件，其内容为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so</div></pre></td></tr></table></figure></p>
<p>在<code>apache2.conf</code>文件中可以发现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">IncludeOptional mods-enabled/*.load</div><div class="line">IncludeOptional mods-enabled/*.conf</div></pre></td></tr></table></figure></p>
<p>也就是说，在apache运行的时候会读取<code>apache2.conf</code>配置文件，然后去加载<code>mods-enabled</code>文件夹下所有模块配置文件，而这些配置文件内部实际上才是真正的加载对应模块。<br>这样将模块分离分多个配置文件，然后引用，层次十分明显，管理起来更加简单（比从<code>httpd.conf</code>中去修改注释的代码行要轻松多了）。</p>
<h2 id="sites"><a href="#sites" class="headerlink" title="sites"></a>sites</h2><p>主要用来管理虚拟主机（<code>virtual host configurations</code>），对应的命令是<code>a2ensite/a2dissite</code>。<br>配置虚拟主机是接下来马上要做的事情了，这里先挖个坑，回头肯定不补充的。</p>
<h2 id="conf"><a href="#conf" class="headerlink" title="conf"></a>conf</h2><p>apache的全局配置包括服务器标识、文件定位、资源限制等，这个我接触的比较少了，参考<a href="https://yq.aliyun.com/ziliao/123882" target="_blank" rel="external">apache服务器全局配置详解(全)</a>。<br><code>conf</code>文件夹主要用来管理全局配置片段（<code>global configuration fragments</code>），对应的命令是<code>a2enconf/a2disconf</code>。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>现在了解到，apache把 整个服务器的各个设置项分布在了不同的配置文件中</p>
<blockquote>
<p>apache2.conf is the main configuration file (this file). It puts the pieces together by including all remaining configuration files when starting up the web server</p>
</blockquote>
<p>实际上这篇文章基本就是根据<code>apache2.conf</code>文件里面的注释展开的，至于实现某个功能（比如开启http缓存）所需要的配置和模块，这里就不唠叨了，跟window下的具体配置并没有什么差别，这里将对应的文件结构进行整理，也仅仅是为了学习一下linux的系统环境罢。</p>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/Apache" class="article_tag">#Apache</a>
        
        <a href="/tags/Ubuntu" class="article_tag">#Ubuntu</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#目录结构"><span class="toc-number">1.</span> <span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mods"><span class="toc-number">2.</span> <span class="toc-text">mods</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sites"><span class="toc-number">3.</span> <span class="toc-text">sites</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conf"><span class="toc-number">4.</span> <span class="toc-text">conf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">5.</span> <span class="toc-text">小结</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>