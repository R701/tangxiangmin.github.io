<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">JavaScript30练习笔记</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/10/18 22:36:55</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/JavaScript" class="hover-highlight">JavaScript</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>很早之前就star了<a href="https://github.com/wesbos/JavaScript30" target="_blank" rel="external">JavaScript30</a>这个项目，却一直没有认真看看（就跟保存在收藏夹的大部分技术文章一样）。最近正在思考如何组织JavaScript代码的问题，决定先从阅读源码开始。下面整理从这个项目中收获到的包括语言特性和代码组织的一些东西。</p>
<a id="more"></a>
<p>参考：</p>
<ul>
<li><a href="https://github.com/wesbos/JavaScript30" target="_blank" rel="external">JavaScript30</a>项目地址</li>
</ul>
<h2 id="JavaScript-Drum-kit"><a href="#JavaScript-Drum-kit" class="headerlink" title="JavaScript Drum kit"></a>JavaScript Drum kit</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> keys = <span class="built_in">Array</span>.from(<span class="built_in">document</span>.querySelectorAll(<span class="string">'.key'</span>));</div><div class="line">keys.forEach(<span class="function"><span class="params">key</span> =&gt;</span> key.addEventListener(<span class="string">'transitionend'</span>, removeTransition));</div></pre></td></tr></table></figure>
<p>这里直接将<code>NodeList</code>转换为了数组，而我之前的做法是使用<code>Array.prototype.forEach.apply</code>，或者是之间使用for循环，相比之下，<code>Array.from</code>这种写法更加合适，参考<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from" target="_blank" rel="external">MDN文档</a>。</p>
<p>以前从已知数组创建新的数组使用的基本都是<code>forEach</code>和<code>map</code>，而<code>Array.from</code>可以从类数组对象中创建新的对象，使用更加灵活。</p>
<p>不过貌似<code>querySelectorAll</code>返回的节点列表自带<code>forEach</code>方法，虽然并不是<code>instanceOf</code>数组的。</p>
<h2 id="Scoped-CSS-Variables-and-JS"><a href="#Scoped-CSS-Variables-and-JS" class="headerlink" title="Scoped CSS Variables and JS"></a>Scoped CSS Variables and JS</h2><p>发现作者习惯将事件绑定和事件处理函数分开书写，这样这个代码看起来比较整洁，而我之前在使用<code>jQuery</code>的时候，往往喜欢事件绑定和事件处理函数写在一起，整个文件都充斥着这样的逻辑代码，看起来很冗杂。这点需要改进。</p>
<p>此外这里还发现了CSS3的变量新特性，有空去深入一下，参考<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_variables" target="_blank" rel="external">MDN文档</a>，貌似兼容性还不太好。</p>
<h2 id="Array-Cardio"><a href="#Array-Cardio" class="headerlink" title="Array Cardio"></a>Array Cardio</h2><p>这里练习<code>Array</code>的相关使用，包括<code>filter</code>，<code>map</code>，<code>sort</code>，<code>reduce</code>，<code>some</code>，<code>every</code>，<code>find</code>，<code>findIndex</code>和<code>slice</code>，此外还出现了数组的解构赋值，这个平常用的比较少，对象的解构赋值倒是用的比较多。</p>
<p>突然发现<code>reduce</code>居然还可以创建一个哈希表，我之前的操作真是弱爆了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> transportation = data.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">obj, item</span>) </span>&#123;</div><div class="line">     <span class="keyword">if</span> (!obj[item]) &#123;</div><div class="line">       obj[item] = <span class="number">0</span>;</div><div class="line">     &#125;</div><div class="line">     obj[item]++;</div><div class="line">     <span class="keyword">return</span> obj;</div><div class="line">   &#125;, &#123;&#125;);</div></pre></td></tr></table></figure>
<p>顺便吐槽一下自己，每次使用<code>reduce</code>都要去翻文档，真是蛋疼~<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce?v=a" target="_blank" rel="external">参考文档</a>，应了那句“半罐水叮当响”，学东西还是要钻研一下才行啊。</p>
<p>其中<code>findIndex</code>貌似也是第一次见到，貌似跟<code>indexOf</code>差不多</p>
<blockquote>
<p>findIndex()方法返回数组中满足提供的测试函数的第一个元素的索引</p>
</blockquote>
<p>原来含义都不相同，跟<code>find</code>一样，用来筛选数组中的元素。</p>
<h2 id="Flex-Panels"><a href="#Flex-Panels" class="headerlink" title="Flex Panels"></a>Flex Panels</h2><p><code>transitionend</code>事件对象包含的<code>propertyName</code>用来判断是哪一个属性结束动画</p>
<p>字符串的<code>includes</code>用来判断是否包含子字符串，比之前使用<code>indexOf</code>判断结果<code>&gt;-1</code>要更好用，因为返回的就是布尔值，<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes" target="_blank" rel="external">参考文档</a></p>
<h2 id="Type-Ahead"><a href="#Type-Ahead" class="headerlink" title="Type Ahead"></a>Type Ahead</h2><p>突然发现了<code>fetch</code>这个API，表示居然一直没有见过!!!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url = <span class="string">"http://localhost:9999/1.php"</span></div><div class="line">fetch(url).then(<span class="function"><span class="params">res</span>=&gt;</span>res.json()).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(res)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>天地良心，这个api比ajax好用得多!想起上次面试笔试手写两页的ajax封装都是泪~关于<code>fetch</code>我觉得可以另外再起几篇博客，<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API" target="_blank" rel="external">参考文档</a>。</p>
<h2 id="Fun-with-HTML5-Canvas"><a href="#Fun-with-HTML5-Canvas" class="headerlink" title="Fun with HTML5 Canvas"></a>Fun with HTML5 Canvas</h2><p>一直以来对于<code>Canvas</code>都存在敬畏之心，感觉要写出酷炫的东西太难了~</p>
<p>这里还了解到了<code>hsl</code>颜色，虽然之前见过却没有深入，<a href="https://baike.baidu.com/item/HSL/1443144?fr=aladdin" target="_blank" rel="external">参考</a></p>
<ul>
<li>H表示颜色范围，取值范围是0~360的圆心角</li>
<li>S表示色彩的饱和度，数值越大，色彩中的灰度越小，颜色越明亮</li>
<li>L表示色彩的明度，控制色彩的明暗变化，数值越大，越接近白色</li>
</ul>
<h2 id="Hold-Shift-and-Check-Checkboxes"><a href="#Hold-Shift-and-Check-Checkboxes" class="headerlink" title="Hold Shift and Check Checkboxes"></a>Hold Shift and Check Checkboxes</h2><p>使用<code>:checked</code>伪类来控制兄弟元素的样式，此外<code>click</code>事件对象还有一个<code>shiftKey</code>的属性，判断是否按下了<code>shift</code>键。</p>
<p>使用原生的JavaScript来操作DOM看起来也十分简洁，比如判断复选框是否选中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// js</span></div><div class="line"><span class="keyword">this</span>.checked</div><div class="line"><span class="comment">// jquery</span></div><div class="line">$(<span class="keyword">this</span>).prop(<span class="string">"checked"</span>)</div><div class="line">$(<span class="keyword">this</span>).is(<span class="string">":checked"</span>)</div></pre></td></tr></table></figure>
<p>如果全世界都用Chrome该多好。</p>
<h2 id="Slide-in-on-Scroll"><a href="#Slide-in-on-Scroll" class="headerlink" title="Slide in on Scroll"></a>Slide in on Scroll</h2><p>实现了一个可以立即执行<code>debounce</code>函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait = <span class="number">20</span>, immediate = true</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> timeout;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> context = <span class="keyword">this</span>, args = <span class="built_in">arguments</span>;</div><div class="line">        <span class="keyword">var</span> later = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            timeout = <span class="literal">null</span>;</div><div class="line">            <span class="keyword">if</span> (!immediate) func.apply(context, args);</div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">var</span> callNow = immediate &amp;&amp; !timeout;</div><div class="line">        clearTimeout(timeout);</div><div class="line">        timeout = setTimeout(later, wait);</div><div class="line">        <span class="keyword">if</span> (callNow) func.apply(context, args);</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>貌似有点bug，事件一直触发，<code>callNow</code>一直为false导致函数无法被调用<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">btn.addEventListener(<span class="string">"click"</span>, debounce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">&#125;, <span class="number">500</span>))</div></pre></td></tr></table></figure></p>
<h2 id="JS-Reference-VS-Copy"><a href="#JS-Reference-VS-Copy" class="headerlink" title="JS Reference VS Copy"></a>JS Reference VS Copy</h2><p>之前对于<code>const</code>的理解漏掉了一个很重要的地方。<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/const" target="_blank" rel="external">参考文档</a><br>在JavaScript中，常量的值只是不能通过再赋值改变，而对于其值本身却可以修改，比如增减数组元素、修改对象属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line">a[<span class="number">3</span>] = <span class="number">1000</span>; <span class="comment">// [1,2,3,1000]</span></div><div class="line"></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>]; <span class="comment">// TypeError: Assignment to constant variable</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">x</span>: <span class="number">1</span> &#125;;</div><div class="line">obj.y = <span class="number">100</span>; </div><div class="line">obj = &#123; <span class="attr">y</span>:<span class="number">100</span> &#125;; <span class="comment">// 同上</span></div></pre></td></tr></table></figure></p>
<h2 id="Webcam-Fun"><a href="#Webcam-Fun" class="headerlink" title="Webcam Fun"></a>Webcam Fun</h2><p><code>Canvas</code>中可以通过<code>contenx.getImageData</code>来操作每个像素点，这个函数返回的对象包含一个<code>Uint8ClampedArray</code>的<code>TypedArray</code>，这个是一个颜色数组，按索引值顺序4个值为一组，分别表示</p>
<ul>
<li>R 红色 (0-255)</li>
<li>G 绿色 (0-255)</li>
<li>B 蓝色 (0-255)</li>
<li>A alpha 通道 (0-255; 0 是透明的，255 是完全可见的)</li>
</ul>
<p>这在之前Canvas粒子动画中了解到，但是并没有深入</p>
<h2 id="SpeechRecognition"><a href="#SpeechRecognition" class="headerlink" title="SpeechRecognition"></a>SpeechRecognition</h2><p>MD到今天才知道浏览的语音识别和语音合成功能，这简直是太高大上了，附上<a href="http://www.zhangxinxu.com/wordpress/2017/01/html5-speech-recognition-synthesis-api/" target="_blank" rel="external">张鑫旭-HTML5语音合成Speech Synthesis API简介</a></p>
<h2 id="Event-Capture-Propagation-Bubbling-and-Once"><a href="#Event-Capture-Propagation-Bubbling-and-Once" class="headerlink" title="Event Capture, Propagation, Bubbling and Once"></a>Event Capture, Propagation, Bubbling and Once</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="external">addEventListener</a>函数的第三个参数原来不仅仅只是用来区分事件捕获和冒泡的。<br>实际上有好几种重载形式，可以通过传入配置参数取代常见的事件传递<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a.addEventListener(&quot;click&quot;, function()&#123;&#125;, &#123;</div><div class="line">    capture: false, // 跟直接传入false等效</div><div class="line">    once: true</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>大概看完了所有demo，原生的Javascript也可以写出很清晰的代码，接下来需要学习的东西包括：</p>
<ul>
<li>fetch</li>
<li>canvas</li>
</ul>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/源码" class="article_tag">#源码</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-Drum-kit"><span class="toc-number">1.</span> <span class="toc-text">JavaScript Drum kit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Scoped-CSS-Variables-and-JS"><span class="toc-number">2.</span> <span class="toc-text">Scoped CSS Variables and JS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Array-Cardio"><span class="toc-number">3.</span> <span class="toc-text">Array Cardio</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flex-Panels"><span class="toc-number">4.</span> <span class="toc-text">Flex Panels</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Type-Ahead"><span class="toc-number">5.</span> <span class="toc-text">Type Ahead</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fun-with-HTML5-Canvas"><span class="toc-number">6.</span> <span class="toc-text">Fun with HTML5 Canvas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hold-Shift-and-Check-Checkboxes"><span class="toc-number">7.</span> <span class="toc-text">Hold Shift and Check Checkboxes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Slide-in-on-Scroll"><span class="toc-number">8.</span> <span class="toc-text">Slide in on Scroll</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS-Reference-VS-Copy"><span class="toc-number">9.</span> <span class="toc-text">JS Reference VS Copy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Webcam-Fun"><span class="toc-number">10.</span> <span class="toc-text">Webcam Fun</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpeechRecognition"><span class="toc-number">11.</span> <span class="toc-text">SpeechRecognition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Capture-Propagation-Bubbling-and-Once"><span class="toc-number">12.</span> <span class="toc-text">Event Capture, Propagation, Bubbling and Once</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">13.</span> <span class="toc-text">总结</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>