<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">node-mysql小记</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/7/26 0:10:21</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/JavaScript" class="hover-highlight">JavaScript</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>最近一直在折腾博客，之前用PHP封装的PDO类凑合着还能使用，迁移到Node之后又写了一个类似的模型类，谁知却经常炸掉，然后老老实实地去翻文档，有了下面的整理。</p>
<a id="more"></a>
<p>参考：</p>
<ul>
<li><a href="https://github.com/mysqljs/mysql" target="_blank" rel="external">mysqljs项目文档</a></li>
</ul>
<p>备注：</p>
<ul>
<li>使用<code>log4js</code>，<code>assert</code>等库进行调试，下面示范代码中只保留核心代码。</li>
<li>下面的<code>mysql</code>统指<code>node</code>下的<code>mysql</code>包</li>
</ul>
<h2 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h2><h3 id="建立连接"><a href="#建立连接" class="headerlink" title="建立连接"></a>建立连接</h3><p>可以调用<code>createConnection()</code>方法快速连接数据库</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> mysql = <span class="built_in">require</span>(<span class="string">"mysql"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建连接对象，后续操作均在conn上进行</span></div><div class="line"><span class="keyword">let</span> conn = mysql.createConnection(&#123;</div><div class="line">    <span class="string">"host"</span>: <span class="string">"localhost"</span>,</div><div class="line">    <span class="string">"user"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line">    <span class="string">"database"</span>: <span class="string">"shymean"</span>,</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 建立连接，这一步不是必须的，在查询中会隐式建立连接</span></div><div class="line">conn.connect(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">  	<span class="comment">// 可以获取连接id</span></div><div class="line">    logger.info(<span class="string">`mysql connect at : <span class="subst">$&#123;<span class="keyword">this</span>.conn.threadId&#125;</span>`</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h3><p>除了建立连接之外，也可以通过连接池来操作数据库。<strong>数据库连接池</strong>的概念并不是node mysql独有的，而是大部分数据库都具备的特性：</p>
<blockquote>
<p>频繁的建立、关闭数据库，会极大的降低系统的性能。数据库连接池负责分配、管理和释放数据库连接，它允许应用程序重复使用一个现有的数据库连接，当用户需要访问数据库时，并非建立一个新的连接，而是从连接池中取出一个已建立的空闲连接对象。使用完毕后，用户也并非将连接关闭，而是将连接放回连接池中，以供下一个请求访问使用…</p>
</blockquote>
<p>连接池这个概念我也不是十分清楚，查了相关资料，貌似更推荐使用连接池进行操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> pool = mysql.createPool(&#123;</div><div class="line">    connectionLimit : <span class="number">10</span>,</div><div class="line">    <span class="string">"host"</span>: <span class="string">"localhost"</span>,</div><div class="line">    <span class="string">"user"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line">    <span class="string">"database"</span>: <span class="string">"shymean"</span>,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当建立连接池之后，就可以对数据库进行操作了（具体的query方法马上会提到）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 直接使用query，每次会随机从连接池分配一个连接</span></div><div class="line">pool.query(sql, values, cb);</div><div class="line"></div><div class="line"><span class="comment">// 某些操作需要保证在同一个连接上进行</span></div><div class="line">pool.getConnection(<span class="function">(<span class="params">err, conn</span>)=&gt;</span>&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    conn.query(sql, values, (err, res)=&gt;&#123;</div><div class="line">    	<span class="comment">// todo</span></div><div class="line">      	<span class="comment">// 释放连接到连接池</span></div><div class="line">      	conn.release();</div><div class="line">    &#125;)		</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>下面来检测一下连接池</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// promise化，这个函数在后面的实例代码中也会使用</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span>(<span class="params">sql, values</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</div><div class="line">        pool.getConnection(<span class="function">(<span class="params">err, conn</span>)=&gt;</span>&#123;</div><div class="line">            assert.ifError(err);</div><div class="line">            conn.query(sql, values, (err, res)=&gt;&#123;</div><div class="line">                assert.ifError(err);</div><div class="line">                resolve(res);</div><div class="line">                </div><div class="line">                logger.debug(conn.threadId);</div><div class="line">                conn.release();</div><div class="line">            &#125;)</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> table = <span class="string">"shymean_admin"</span>;</div><div class="line"></div><div class="line"><span class="comment">// mock</span></div><div class="line"><span class="keyword">let</span> tasks = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i )&#123;</div><div class="line">    tasks.push(</div><div class="line">        query(<span class="string">`SELECT * FROM <span class="subst">$&#123;table&#125;</span> WHERE id = ?`</span>, &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;)</div><div class="line">    )</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Promise</span>.all(tasks).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>可以看见控制台会依次输出三条<code>threadId</code>，打开mysql控制台查看当前连接数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">show processlist;</div></pre></td></tr></table></figure>
<p>可以查看到对应的连接记录，<code>Id</code>字段即为控制台输出的连接id，，想了解更多可以查看<a href="http://www.2cto.com/database/201304/202448.html" target="_blank" rel="external">processlist输出解释</a>。</p>
<h3 id="关闭连接"><a href="#关闭连接" class="headerlink" title="关闭连接"></a>关闭连接</h3><p>关闭连接可以使用    <code>conn.end(err=&gt;{})</code>或<code>destroy()</code>方法，区别在于destroy方法不接收回调函数而立即关闭连接。</p>
<p>关闭连接池可以调用<code>pool.end(err=&gt;{})</code>来关闭连接池。</p>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><h3 id="query"><a href="#query" class="headerlink" title="query"></a>query</h3><p>查询是最基本和最重要的操作，使用的接口是<code>query</code>，可以接收三种形式的参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> table = <span class="string">"shymean_admin"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 直接传入sql语句</span></div><div class="line">conn.query(<span class="string">`SELECT id, name FROM <span class="subst">$&#123;table&#125;</span>`</span>, (err, res)=&gt;&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    logger.debug(res);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 使用占位符，跟PDO相似</span></div><div class="line"><span class="comment">// 关于占位符后面会再提到</span></div><div class="line">conn.query(<span class="string">`SELECT ?? FROM <span class="subst">$&#123;table&#125;</span> WHERE name = ?`</span>, [[<span class="string">"id"</span>, <span class="string">"name"</span>], <span class="string">"root"</span>], (err, res)=&gt;&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    logger.debug(res);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 传入配置</span></div><div class="line"><span class="comment">// 这里也可以将跟上面的占位符方式类一样，将values作为第二个参数传入，此时会覆盖配置中的values属性</span></div><div class="line">conn.query(&#123;</div><div class="line">    sql: <span class="string">`SELECT ?? FROM <span class="subst">$&#123;table&#125;</span> WHERE name = ?`</span>,</div><div class="line">    timeout: <span class="number">1000</span>,</div><div class="line">    values: [[<span class="string">"id"</span>, <span class="string">"name"</span>], <span class="string">"root"</span>]</div><div class="line">&#125;, (err, res)=&gt;&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    logger.debug(res);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>为了防止sql注入，一般需要对查询值进行编码，对应的方法是<code>mysql.escape()</code>或<code>conn.escape()</code>。如果使用了占位值的形式，则其实际也是使用了<code>conn.escape</code>方法。</p>
<h3 id="占位符"><a href="#占位符" class="headerlink" title="占位符"></a>占位符</h3><p>占位符是一个很方便的功能，后面重写的模型类会着重考虑这点。</p>
<p>除了默认<code>?</code>占位形式，还可以通过配置参数<code>queryFormat</code>自定义格式化方法，参考<a href="https://github.com/mysqljs/mysql#custom-format" target="_blank" rel="external">文档</a>。</p>
<p>文档中的示例展示了如何将占位符修改为<code>:key</code>的形式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 修改queryFormat方法</span></div><div class="line">conn.config.queryFormat = <span class="function"><span class="keyword">function</span> (<span class="params">query, values</span>) </span>&#123;</div><div class="line">  	<span class="comment">// values是query方法的第二个参数</span></div><div class="line">    <span class="keyword">if</span> (!values) <span class="keyword">return</span> query;</div><div class="line">  </div><div class="line">    <span class="keyword">return</span> query.replace(<span class="regexp">/\:(\w+)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">txt, key</span>) </span>&#123;</div><div class="line">      	<span class="comment">// 第一个参数是正则匹配到的真个字符串，即在sql语句中的占位符</span></div><div class="line">        logger.debug(txt)</div><div class="line">        <span class="comment">// 后续参数依次为匹配到的分组</span></div><div class="line">        logger.debug(key)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (values.hasOwnProperty(key)) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.escape(values[key]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> txt;</div><div class="line">    &#125;.bind(<span class="keyword">this</span>));</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 现在的占位格式化方式已修改，十分灵活</span></div><div class="line">conn.query(<span class="string">`SELECT * FROM <span class="subst">$&#123;table&#125;</span> WHERE id = :id`</span>, &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;, (err, res)=&gt;&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    logger.debug(res);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="查询值"><a href="#查询值" class="headerlink" title="查询值"></a>查询值</h3><p>sql语句的不少子句都可以看作是键值对的形式，比如<code>WHERE</code>，<code>VALUES</code>等，这对于JS来说传入对象似乎是一件很合理的事情</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">query(<span class="string">`SELECT id, name FROM <span class="subst">$&#123;table&#125;</span> WHERE ?`</span>, &#123;<span class="attr">id</span>: <span class="number">1</span>&#125;).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</div><div class="line">    logger.debug(res);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在进行<code>INSERT</code>和<code>UPDATE</code>等操作时可以直接使用对象字面量来简化占位符（只需要一个就够了），不过这种情况对于<code>WHERE</code>操作的<code>&gt;</code>和<code>&lt;</code>等筛选条件就无能为力了</p>
<h3 id="多查询"><a href="#多查询" class="headerlink" title="多查询"></a>多查询</h3><p>可以在一条<code>query</code>语句中执行多次查询操作，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">query(<span class="string">`SELECT 1; SELECT 2`</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</div><div class="line">    logger.debug(res[<span class="number">0</span>]);</div><div class="line">	logger.debug(res[<span class="number">1</span>]);</div><div class="line">&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</div><div class="line">    logger.debug(err);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>需要在<code>createConnection()</code>或<code>createPool()</code>的配置参数中配置<code>multipleStatements: true</code>，不过这项操作的意义感觉不是很大~</p>
<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><blockquote>
<p>事务用来维护数据库的完整性，他保证成批的mysql操作要么完全执行，要么完全不执行。</p>
</blockquote>
<p>使用事务的前提是数据库引擎得支持事务才行，这里采用<code>InnoDB</code>。<code>mysql</code>提供了对应的方法来来建立数据库事务，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// START TRANSACTION</span></div><div class="line">conn.beginTransaction(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</div><div class="line">    assert.ifError(err);</div><div class="line">    <span class="keyword">let</span> thread = conn.query(sql, values, (err, res)=&gt;&#123;</div><div class="line">        <span class="keyword">if</span> (err)&#123;</div><div class="line">        	<span class="comment">// ROLLBACK</span></div><div class="line">            conn.rollback(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">                <span class="keyword">throw</span> err;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// do something</span></div><div class="line">        </div><div class="line">        <span class="comment">// COMMIT</span></div><div class="line">        conn.commit(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</div><div class="line">            <span class="keyword">if</span> (err)&#123;</div><div class="line">                conn.rollback(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">                    <span class="keyword">throw</span> err;</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>三个方法对应的就是MySQL的事务操作，不过事务这块我也不熟（好吧，数据库我根本就不会~）</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>增删改操作跟查询最大的区别在于对于返回值的需求不同，下面有几个很有用的特性:</p>
<ul>
<li>获取插入记录的id值<code>res.insertId</code></li>
<li>获取增删改操作影响的行数<code>res.affectedRows</code></li>
<li>获取更新操作改变的行数<code>res.changedRows</code></li>
</ul>
<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>之前把博客后台从PHP迁移到Node的时候写了一个简陋的数据库操作类，主要是对操作进行了Promise封装。起初能满足基本的需求，但是在开发过程中逐渐发现了一些问题</p>
<ul>
<li>每个模型实例都维护了一个连接对象，因此不能再调用之后关闭连接（压根不知道连接池这种东西~）</li>
<li>为了满足链式调用，许多方法都只是为最后拼接的sql语句服务，也没有用占位符啥的</li>
<li>没有考虑错误处理</li>
<li>代码写的太烂了，强行面向对象~</li>
</ul>
<p>这两天翻了<code>mysqljs</code>的文档之后，决定重写这个模型类，代码已经整合在<a href="">github</a>上，请多多指教。</p>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/nodejs" class="article_tag">#nodejs</a>
        
        <a href="/tags/mysql" class="article_tag">#mysql</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#连接"><span class="toc-number">1.</span> <span class="toc-text">连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#建立连接"><span class="toc-number">1.1.</span> <span class="toc-text">建立连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#连接池"><span class="toc-number">1.2.</span> <span class="toc-text">连接池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关闭连接"><span class="toc-number">1.3.</span> <span class="toc-text">关闭连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作"><span class="toc-number">2.</span> <span class="toc-text">操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#query"><span class="toc-number">2.1.</span> <span class="toc-text">query</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#占位符"><span class="toc-number">2.2.</span> <span class="toc-text">占位符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询值"><span class="toc-number">2.3.</span> <span class="toc-text">查询值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多查询"><span class="toc-number">2.4.</span> <span class="toc-text">多查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#事务"><span class="toc-number">2.5.</span> <span class="toc-text">事务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-number">2.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封装"><span class="toc-number">3.</span> <span class="toc-text">封装</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>