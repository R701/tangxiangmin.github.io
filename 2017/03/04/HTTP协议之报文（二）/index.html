<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">HTTP协议之报文（二）</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/3/4 20:05:56</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/计算机基础" class="hover-highlight">计算机基础</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>有一个经典的问题：在浏览器地址栏输入地址，然后回车，最后看见页面这个过程到底发生了什么？这个过程，用书面语来讲就是一个完整的<strong>浏览器事务</strong>。一个事务由一条请求命令（浏览器发往服务器）和一条响应结果（服务器发往浏览器）组成，而这种通信是通过<strong>HTTP报文</strong>进行的。学习HTTP，最基本的目标就是需要看懂HTTP报文。</p>
<a id="more"></a>
<p>学习报文的时候，最好顺手打开一个网页（推荐Chorme浏览器），<code>F12</code>打开开发者工具，然后切换到<code>Network</code>面板，然后下方左侧<code>Name</code>列表随便选择一条，然后在右侧切换到<code>Header</code>面板，现在就可以愉快地学习啦。</p>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>HTTP报文是浏览器和服务器之间发送的数据块，一条报文可能是请求报文，也可能是响应报文，但是他们都由三部分组成：</p>
<ul>
<li>对报文进行描述的<strong>起始行</strong></li>
<li>包含属性的<strong>首部块</strong></li>
<li>可选的，包含数据的<strong>主体部分</strong></li>
</ul>
<p>下面是具体语法（从书上抄过来的）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 请求报文</div><div class="line">&lt;method&gt;&lt;request-URL&gt;&lt;version&gt;  // 起始行</div><div class="line">&lt;header&gt; 					    // 首部行</div><div class="line">&lt;entity-body&gt;					// 主体</div><div class="line"></div><div class="line">// 响应报文</div><div class="line">&lt;version&gt;&lt;status&gt;&lt;reason-phrase&gt;  // 起始行</div><div class="line">&lt;header&gt; 					    // 首部行</div><div class="line">&lt;entity-body&gt;					// 主体</div></pre></td></tr></table></figure></p>
<h2 id="起始行"><a href="#起始行" class="headerlink" title="起始行"></a>起始行</h2><p>请求报文和响应报文最主要的结构区别在于起始行不一样：</p>
<ul>
<li>请求报文的首部行包含请求方法，资源URL和HTTP版本号</li>
<li>响应报文包含HTTP版本号，请求资源的响应状态（一个三位数）和原因短语（一个英语短语文本）</li>
</ul>
<h3 id="HTTP版本号"><a href="#HTTP版本号" class="headerlink" title="HTTP版本号"></a>HTTP版本号</h3><p>在报文中提供版本号的目的是为了让使用HTTP的应用程序了解双方的的协议能力和报文格式：采用老版本的协议可能无法实现新版本协议的某些特性。HTTP从开始到现在的版本包括<code>HTTP0.9</code>,<code>HTTP1.0</code>,<code>HTTP1.1</code>(目前最常用),<code>HTTP2.0</code>（二十来年就这么几个版本，可见学习基础的东西是非常划算的）。另外，需要注意的是HTTP协议貌似是一个十分考虑向后兼容的协议</p>
<h3 id="资源URL"><a href="#资源URL" class="headerlink" title="资源URL"></a>资源URL</h3><p>就是前面所提到的请求资源的路径。既然是请求报文，肯定是请求资源啦，不带上URL的话HTTP怎么知道把这个报文扔哪去</p>
<h3 id="请求方法"><a href="#请求方法" class="headerlink" title="请求方法"></a>请求方法</h3><p>请求报文中的请求方法表明服务器针对该请求应当执行的操作，常见的请求方法有:</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:left">从服务器获取一份文档</td>
</tr>
<tr>
<td style="text-align:center">HEAD</td>
<td style="text-align:left">只从服务器获取文档的首部</td>
</tr>
<tr>
<td style="text-align:center">POST</td>
<td style="text-align:left">向服务器发送需要处理的数据</td>
</tr>
<tr>
<td style="text-align:center">PUT</td>
<td style="text-align:left">将请求的主体放在服务器上</td>
</tr>
<tr>
<td style="text-align:center">TRACE</td>
<td style="text-align:left">追踪报文经过的代理服务器</td>
</tr>
<tr>
<td style="text-align:center">OPTIONS</td>
<td style="text-align:left">决定可以在服务器上执行哪些方法</td>
</tr>
<tr>
<td style="text-align:center">DELETE</td>
<td style="text-align:left">删除一份文档</td>
</tr>
</tbody>
</table>
<p>最常用的方法大概就是<code>GET</code>和<code>POST</code>方法了。HTML文档中表单method属性的<code>get</code>和<code>post</code>,在数据传输过程中分别对应了HTTP协议中的GET和POST方法，区别在于：</p>
<ul>
<li>目的不同，Get是用来从服务器上获得数据，而Post是用来向服务器上传递数据。</li>
<li>传递请求数据的方式不同，GET将参数添加在URL的查询字段后（URL位于请求报文的起始行），而POST将请求数据放在请求报文的主体部分</li>
<li>由于浏览器可能缓存带有查询字段的URL，因此不能保证安全而被其他访问者查看；此外，某些浏览器对于URL的长度是有限制的，服务器一般也对URL长度有某些限制（超过会返回414错误，关于状态码马上就会讲到），因此在需要向服务器传递大量数据的时候一般使用POST方法</li>
</ul>
<p>在工作中，GET方法可以应用在数据分页，跳转重定向等地方，而POST方法主要应用在账户登录，编辑信息提交等方面。<br>POST与GET的另外一个区别在于：GET方式请求的资源可以被缓存，而POST请求无法被缓存。缓存这个问题十分重要，咱们后面再详细了解。</p>
<h3 id="响应状态"><a href="#响应状态" class="headerlink" title="响应状态"></a>响应状态</h3><p>状态码是一个三位数，第一位描述状态的一般类别（成功，失败…），后两位描述状态的详细信息，其中：</p>
<ul>
<li>1，表示信息提示</li>
<li>2，表示请求成功，常见的状态码是<code>200</code>，对应的原因短语是<code>OK</code>。</li>
<li>3，表示重定向，要么告知客户端使用替代位置来访问他们感兴趣的资源，要么是服务器提供一个替代的响应而不是请求资源的内容。这在缓存中十分常见，常见的状态码是<code>304 Not Modified</code>，表示资源未修改，可直接使用缓存（缓存这个问题对于前端十分重要，后面会花很多时间来学习的）</li>
<li>4，表示客户端错误，指浏览器发送了服务器无法处理的内容，比如最常见的<code>404 Not Found</code>表示服务器上不存在该资源</li>
<li>5，表示服务端错误，有时候请求是有效的，服务端却出现错误，比如某段PHP漏了一个分号啥的，常见的是<code>502 Bad Gateway</code>表示无法连接</li>
</ul>
<p>书中详细讲解了五类响应状态的完整状态码，就不搬过来了，这里是<a href="https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81" target="_blank" rel="external">维基百科的链接</a>，遇见不熟悉的状态码再回来查吧。</p>
<h2 id="首部行"><a href="#首部行" class="headerlink" title="首部行"></a>首部行</h2><p>起始行提供了整个报文的一个概览，在某些只需要了解报文的基本信息而不需要具体的资源信息（比如判断一个资源是否存在），我们可以使用<code>HEAD</code>方法发送请求，这个方法就只会返回报文的首部行。<br>因为起始行能够包含的信息太少了，在使用HEAD请求的时候会非常便捷。但是，在更多的时候，客户端和服务端都需要为报文提供更详细的信息。</p>
<p>首部行提供报文的额外描述信息，用来准确描述正在获取的资源、服务器或者客户端的行为。报文首部行由一组不区分大小写的属性名后跟一个冒号，再紧跟它的值（不必换行）的键值对组成，值前面的空格会被忽略掉。</p>
<p>有些首部信息是请求报文或响应报文专用的，有些首部则更通用一些。由于首部行的数量也比较多，因此下面只列举了一些经常遇见的首部行，这里是HTTP首部行字段的<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers" target="_blank" rel="external">MDN文档</a>。后面在学习HTTP连接，HTTP识别和认证，缓存等知识时，也会回过头来重新了解相关的首部行。</p>
<h3 id="通用首部"><a href="#通用首部" class="headerlink" title="通用首部"></a>通用首部</h3><p>表示服务器和浏览器都可以使用的首部，又可以分为</p>
<ul>
<li>普通首部，提供与报文相关的最基本的信息，如<code>Date</code>，用来说明构建报文的时间和日期</li>
<li>缓存首部，将资源缓存到本地副本，如<code>Cache-Control</code>, 特别指定缓存策略</li>
</ul>
<h3 id="请求首部"><a href="#请求首部" class="headerlink" title="请求首部"></a>请求首部</h3><p>请求报文独有的，为服务器提供关于请求数据的额外信息，又可以分为</p>
<ul>
<li>Accept首部，将客户端的资源喜好和处理能力告知服务器，如<code>Accept</code>, 表示浏览器所希望接收的数据类型</li>
<li>条件请求首部，为请求加上某些限制，如<code>If-Modified-Since</code>, 只有资源在指定事件后改变才发送该资源</li>
<li>安全请求首部，允许客户端在请求资源之前先对自身进行认证，如<code>Cookie</code>, 用来帮助服务器识别客户端的身份</li>
<li>代理请求首部，协助因特网代理更好地工作</li>
</ul>
<h3 id="响应首部"><a href="#响应首部" class="headerlink" title="响应首部"></a>响应首部</h3><p>响应报文独有的，向浏览器提供服务器的额外信息，又可以分为</p>
<ul>
<li>协商首部，为服务端和客户端对资源进行协商的能力，如<code>Accept-Ranges</code>，表示服务端对该资源可以接受的类型</li>
<li>安全响应首部，是HTTP的质询/响应认证机制的响应侧，如<code>Set-Cookie</code>用于在客户端设置一个Cookie</li>
</ul>
<h3 id="实体首部"><a href="#实体首部" class="headerlink" title="实体首部"></a>实体首部</h3><p>可以用来说明实体主体及其内容部分的信息，又可以分为</p>
<ul>
<li>内容首部，表示实体内容的类型，尺寸以及处理它所需的其他有用信息，如<code>Content-Length</code>,表明响应主体的内容长度</li>
<li>实体缓存首部，用于提供与被缓存实体有关的信息，如<code>Expires</code>, 用于指定了HTTP响应的过期时间</li>
</ul>
<h2 id="实体"><a href="#实体" class="headerlink" title="实体"></a>实体</h2><p>HTTP协议负责传送资源（只要声明了正确的URL），而报文的实体部分就是用来保存资源内容的。此外，HTTP还负责确保它的报文被正确传送，识别提取和适当处理，具体来说，HTTP需要确保他传送的资源满足下面的条件：</p>
<ul>
<li>可以被客户端正确识别（<code>Content-type</code>和<code>Content-Language</code>来表明资源类型和语言）以及正确地解包(<code>Content-Length和Content-Encoding</code>)</li>
<li>是最新的（通过实体验证码和缓存过期限制），也是用户所需要的（通过内容协商）</li>
<li>可以被快速传输（通过范围传输，差异编码和其他数据压缩方法），且完整到达，未被篡改（通过校验）</li>
</ul>
<p>HTTP主要就是用来传送资源，上面列举了与资源传送相关的各种技术，每一项技术都很难直接通过简单地学习就能理解，关于主体部分，针对前端工作，我觉得应该首先应该掌握的是<strong>内容缓存</strong>，接下来的就让我们来弄个明白缓存到底是个什么鬼。</p>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/读书笔记" class="article_tag">#读书笔记</a>
        
        <a href="/tags/HTTP" class="article_tag">#HTTP</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#基本语法"><span class="toc-number">1.</span> <span class="toc-text">基本语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#起始行"><span class="toc-number">2.</span> <span class="toc-text">起始行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP版本号"><span class="toc-number">2.1.</span> <span class="toc-text">HTTP版本号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#资源URL"><span class="toc-number">2.2.</span> <span class="toc-text">资源URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请求方法"><span class="toc-number">2.3.</span> <span class="toc-text">请求方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#响应状态"><span class="toc-number">2.4.</span> <span class="toc-text">响应状态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#首部行"><span class="toc-number">3.</span> <span class="toc-text">首部行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通用首部"><span class="toc-number">3.1.</span> <span class="toc-text">通用首部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请求首部"><span class="toc-number">3.2.</span> <span class="toc-text">请求首部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#响应首部"><span class="toc-number">3.3.</span> <span class="toc-text">响应首部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实体首部"><span class="toc-number">3.4.</span> <span class="toc-text">实体首部</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实体"><span class="toc-number">4.</span> <span class="toc-text">实体</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>