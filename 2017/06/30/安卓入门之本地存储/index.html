<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
            <a class="nav_item" href="/test">Test</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">安卓入门之本地存储</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/6/30 8:39:36</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/Android" class="hover-highlight">Android</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>Android提供了在本地存储数据的功能，这在需求（比如保存登陆密码）和性能（缓存数据）方面是十分有用的。下面整理安卓中本地数据存储的知识，跟前面一样，我们将对比web中的数据存储来学习（PS：貌似还没有写过localStorage相关的博客呢~）</p>
<a id="more"></a>
<p>参考：</p>
<ul>
<li>《第一行代码 Android》</li>
</ul>
<h2 id="文件存储"><a href="#文件存储" class="headerlink" title="文件存储"></a>文件存储</h2><p>在web中，由于安全限制，<strong>数据持久化</strong>的实现一般是依赖浏览器实现的，从最初的<code>cookie</code>存储到HTML5中的<code>localStorage</code>和<code>sessionStorage</code>，以及<code>Web SQL Databases</code>等。</p>
<p>在Android中，可以使用系统原生的文件IO功能，因此在硬盘上存储数据变得简单很多。 其具体实现就是：把数据以文件的形式导出到硬盘上，再需要的时候再通过读取文件来恢复数据。</p>
<h3 id="存储数据"><a href="#存储数据" class="headerlink" title="存储数据"></a>存储数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveFileData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    String data = <span class="string">"Hello file"</span>;</div><div class="line">    FileOutputStream out = <span class="keyword">null</span>;</div><div class="line">    BufferedWriter writer = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        out = openFileOutput(<span class="string">"testData"</span>, Context.MODE_PRIVATE);</div><div class="line">        writer = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(out));</div><div class="line">        writer.write(data);</div><div class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;<span class="keyword">finally</span> &#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">if</span> (writer != <span class="keyword">null</span>)&#123;</div><div class="line">                Log.i(TAG, <span class="string">"done~~"</span>);</div><div class="line">                writer.close();</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的方法新建了一个<code>testData</code>的文件，并向其中写入了需要保存的数据<code>&quot;Hello file&quot;</code>，然后打开<code>DDMS</code>，沿着路径<code>/data/data/应用包名/files</code>可以查看对应的文件了，将文件导入查看，可以发现实际上就是一个纯文本文件（如果使用DDMS遇见了问题，请参考最后一章，因为我也遇见了很多问题~）。</p>
<h3 id="读取文件数据"><a href="#读取文件数据" class="headerlink" title="读取文件数据"></a>读取文件数据</h3><p>纯文本文件意味着，我们读取获得的就是整个文件内容（一个字符串），如果需要获得特定的内容，则需要按照一定的格式存储（比如按行或特定的分隔符啥的），最后使用对应的格式进行解析</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getFileData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    FileInputStream in = <span class="keyword">null</span>;</div><div class="line">    BufferedReader reader = <span class="keyword">null</span>;</div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        in = openFileInput(<span class="string">"testData"</span>);</div><div class="line">        reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</div><div class="line">        String line = <span class="string">""</span>;</div><div class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>)&#123;</div><div class="line">            sb.append(line);</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;<span class="keyword">finally</span> &#123;</div><div class="line">        <span class="keyword">if</span> (reader != <span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">            	<span class="comment">// 获取到了文件内容</span></div><div class="line">                Log.i(TAG, sb.toString());</div><div class="line">                reader.close();</div><div class="line">            &#125;<span class="keyword">catch</span> (IOException e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过<code>StringBuilder</code>对象逐行拼接文件内容，最后输出的就是一个字符串~</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>通过纯文本来保存一些简单的文本信息还好（比如保存用户的编辑草稿？），如果保存一些有特定格式的数据，可能就不是很实用了。</p>
<p>PS：Java中的异常处理是强制的，对于程序的健壮性来说是好的，但总归有点不太习惯</p>
<h2 id="SharedPreferences"><a href="#SharedPreferences" class="headerlink" title="SharedPreferences"></a>SharedPreferences</h2><p>上面提到，使用纯文本文件来保存的数据，在读取部分特定数据时比较麻烦，在需求中，除了能够保存本地数据之外，更方便的读取数据也是一个很重要的因素。</p>
<p>Android提供了<code>SharedPreferences</code>，将数据以<strong>键值对</strong>的形式，以<strong>xml</strong>文件格式保存在本地，这样，在读取数据的时候只需要提供指定的键值，就可以获得对应的数据了。就接口的用法来将，我感觉SharedPreferences跟localStorage简直一模一样啊~</p>
<h3 id="存储数据-1"><a href="#存储数据-1" class="headerlink" title="存储数据"></a>存储数据</h3><p>只需要获得<code>SharedPreferences.Editor</code>实例，然后调用对应的<code>put</code>接口就可以了，比起冗长的文件流保存和异常处理，这里的代码简单得多。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveLocalData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">  	<span class="comment">// xml文件夹名称为data</span></div><div class="line">    SharedPreferences.Editor editor = getSharedPreferences(<span class="string">"data"</span>, MODE_PRIVATE).edit();</div><div class="line">  	<span class="comment">// 存储的主要是java内置类型</span></div><div class="line">    editor.putString(<span class="string">"name"</span>, <span class="string">"txm"</span>);</div><div class="line">    editor.putString(<span class="string">"password"</span>, <span class="string">"123456"</span>);</div><div class="line">  	<span class="comment">// editor.commit();</span></div><div class="line">    editor.apply();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用<code>put</code>接口之后，需要调用<code>commit</code>或<code>apply</code>进行确认，最终保存数据。关于这两个方法的区别，请移步<a href="http://blog.csdn.net/jake9602/article/details/18414841" target="_blank" rel="external">这里</a>，主要区别在于：</p>
<ul>
<li><code>apply</code>将数据提交到内存，然后异步保存到硬盘，因此效率更高，但是当连续调用apply时，后续调用apply可能覆盖前面apply的数据</li>
<li><code>commit</code>将数据同步保存到磁盘上，因此效率慢，但是可以返回一个操作状态的布尔值</li>
</ul>
<p>在执行存储操作之后，打开DDMS，我们可以在<code>data/data/包名/shared_prefs</code>文件夹下发现对应的xml文件了，可以导出查看具体的文件内容。（同上，如果DDMS出现问题，请参考最后一章）</p>
<h3 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h3><p>同理，读取数据只需要获得<code>SharedPreferences</code>实例，然后调用对应的<code>get</code>接口即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getLocalData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    SharedPreferences pref = getSharedPreferences(<span class="string">"data"</span>, MODE_PRIVATE);</div><div class="line">    <span class="comment">// 第二个参数是默认值</span></div><div class="line">    String name = pref.getString(<span class="string">"name"</span>, <span class="string">""</span>);</div><div class="line">    String password = pref.getString(<span class="string">"password"</span>, <span class="string">""</span>);</div><div class="line">    Log.i(TAG, <span class="string">"name: "</span> + name);</div><div class="line">    Log.i(TAG, <span class="string">"password: "</span> + password);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><p>使用xml保存数据的应用范围就广一些了，比如保存登陆密码，用户偏好设置啥的。但是如果本地缓存重复字段的列表数据，可能也不是那么方便，接下来就是数据存储最重要的部分<strong>SQLite</strong>了。</p>
<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p>Android系统内置了这个SQLite的关系型数据库，可以很方便的实现数据存储。数据库是一个很广泛的概念，这里只能先整理基础使用方法。</p>
<h3 id="新建数据库"><a href="#新建数据库" class="headerlink" title="新建数据库"></a>新建数据库</h3><p>新建数据库需要定义一个继承自<code>SQLiteOpenHelper</code>的Helper类，然后重写<code>onCreate</code>和<code>onUpgrade</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDataBaseHelper</span> <span class="keyword">extends</span> <span class="title">SQLiteOpenHelper</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"shymean"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CREATE_USER = <span class="string">"create table user (id integer primary key autoincrement, name text, password text)"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Context mContext;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyDataBaseHelper</span><span class="params">(Context context, String name, SQLiteDatabase.CursorFactory factory, <span class="keyword">int</span> versrion)</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, name, factory, versrion);</div><div class="line">        mContext = context;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span></span>&#123;</div><div class="line">      	<span class="comment">// 第一次创建的运行</span></div><div class="line">        db.execSQL(CREATE_USER);</div><div class="line">        Toast.makeText(mContext, <span class="string">"create success"</span>, Toast.LENGTH_SHORT).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="keyword">int</span> oldVersion, <span class="keyword">int</span> newVersion)</span></span>&#123;</div><div class="line">       	<span class="comment">// todo</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后在对应的Activity中实例化一个数据库对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">db = <span class="keyword">new</span> MyDataBaseHelper(<span class="keyword">this</span>, <span class="string">"Test.db"</span>, <span class="keyword">null</span>, <span class="number">1</span>);</div><div class="line">dbHelper.getWritableDatabase();</div><div class="line"><span class="comment">// 然后根据dbHelper操作对应的数据库Test数据库</span></div></pre></td></tr></table></figure>
<p>打开DDMS，修改模拟器权限啥的之后进入<code>data/data/包名/databases</code>中就可以看见对应的数据库文件<code>Test.db</code>了（还有一个<code>Test.db-journal</code>文件，该文件是一个临时的日志文件，用于数据库事务的回滚机制，可以暂时先不用理会）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> 进入数据库</span></div><div class="line">sqlite3 Test.db</div><div class="line"><span class="meta">#</span><span class="bash"> 查看表</span></div><div class="line">.tables</div></pre></td></tr></table></figure>
<p>可以看见刚才新增了<code>user</code>表，除此之外还有一个默认的<code>android_metadata</code>表，此时就可以执行相关的sql语句了。</p>
<h3 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h3><p><strong>插入数据</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    SQLiteDatabase db = dbHelper.getWritableDatabase();</div><div class="line">    ContentValues values = <span class="keyword">new</span> ContentValues();</div><div class="line"></div><div class="line">    values.put(<span class="string">"name"</span>, <span class="string">"txmmm"</span>);</div><div class="line">    values.put(<span class="string">"password"</span>, <span class="string">"123456"</span>);</div><div class="line">    db.insert(<span class="string">"user"</span>, <span class="keyword">null</span>, values);</div><div class="line"></div><div class="line">    Log.i(TAG, <span class="string">"add data..."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>更新数据</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    SQLiteDatabase db = dbHelper.getWritableDatabase();</div><div class="line"></div><div class="line">    ContentValues values = <span class="keyword">new</span> ContentValues();</div><div class="line">    values.put(<span class="string">"name"</span>, <span class="string">"updateTXX"</span>);</div><div class="line">    db.update(<span class="string">"user"</span>, values, <span class="string">"id = ?"</span>, <span class="keyword">new</span> String[]&#123;<span class="string">"1"</span>&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>删除数据</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    SQLiteDatabase db = dbHelper.getWritableDatabase();</div><div class="line"></div><div class="line">    db.delete(<span class="string">"user"</span>, <span class="string">"id &gt; ?"</span>, <span class="keyword">new</span> String[]&#123;<span class="string">"3"</span>&#125;);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>查询数据</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queryData</span><span class="params">(View view)</span></span>&#123;</div><div class="line">    Log.i(TAG, <span class="string">"get data..."</span>);</div><div class="line">    SQLiteDatabase db = dbHelper.getWritableDatabase();</div><div class="line">    Cursor cursor = db.query(<span class="string">"user"</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">    <span class="keyword">if</span> (cursor.moveToFirst())&#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            String name = cursor.getString(cursor.getColumnIndex(<span class="string">"name"</span>));</div><div class="line">            Log.i(TAG, <span class="string">"name: "</span> + name);</div><div class="line">        &#125;<span class="keyword">while</span> (cursor.moveToNext());</div><div class="line">    &#125;</div><div class="line">    cursor.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里的query方法接收的参数表示对应的查询子句</p>
<h3 id="原生sql语句"><a href="#原生sql语句" class="headerlink" title="原生sql语句"></a>原生sql语句</h3><p>实际上上面的这些方法都是Android对SQLite进行的封装，SQLite的语法跟其他sql语言的语法基本相似，我们可以使用<code>execSQL</code>执行原生的数据库操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.execSQL(&quot;insert into user (name, password) values(?, ?)&quot;, new String[]&#123;&quot;txm&quot;, &quot;123456&quot;&#125;);</div></pre></td></tr></table></figure>
<p>是不是很赞？</p>
<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><p>这里粘了很多代码上来，也许几个月回头看就会觉得这些代码太丑陋了，现在先将就着吧，之前用PHP和NodeJS的时候也封装过一些数据库类，这里学起来也没有那么晦涩。总之，SQLite应该是客户端开发中比较重要的东西，还是得慢慢学习。</p>
<h2 id="DDMS的问题"><a href="#DDMS的问题" class="headerlink" title="DDMS的问题"></a>DDMS的问题</h2><p>在刚开始使用AS中模拟器的DDMS的时候遇见了不少问题，这里一并整理。</p>
<h3 id="打开data文件夹是空的？"><a href="#打开data文件夹是空的？" class="headerlink" title="打开data文件夹是空的？"></a>打开data文件夹是空的？</h3><p>如果发现根目录下的data文件夹是空，这是因为没有相关目录权限的关系，找到你的Android Studio存放sdk的目录，然后切换到<code>sdk/platform-tools</code>，打开控制台，输入下面命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">adb shell</div><div class="line">su</div><div class="line">chmod 777 /data </div><div class="line"><span class="meta">#</span><span class="bash"> 如果只是想修改某个应用包的权限，把*替换成对应文件名即可</span></div><div class="line">chmod 777 /data/data * -R</div></pre></td></tr></table></figure>
<h3 id="文件无法导出"><a href="#文件无法导出" class="headerlink" title="文件无法导出"></a>文件无法导出</h3><p>修改文件的访问权限就可以在目录中看见文件的存在了，但是却无法查看文件内容，这是因为模拟器权限的缘故</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">adb root</div><div class="line">adb remount</div><div class="line"></div><div class="line"><span class="meta">#</span><span class="bash"> 出现 remount succeeded则成功</span></div></pre></td></tr></table></figure>
<p>此时选择文件然后右上角的<code>pull a file from the device</code>即可</p>
<h2 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h2><p>这篇文章粘贴了大量的代码，却没有啥干货，先挖些坑后面填吧。</p>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/sqlite" class="article_tag">#sqlite</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#文件存储"><span class="toc-number">1.</span> <span class="toc-text">文件存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#存储数据"><span class="toc-number">1.1.</span> <span class="toc-text">存储数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读取文件数据"><span class="toc-number">1.2.</span> <span class="toc-text">读取文件数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结"><span class="toc-number">1.3.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SharedPreferences"><span class="toc-number">2.</span> <span class="toc-text">SharedPreferences</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#存储数据-1"><span class="toc-number">2.1.</span> <span class="toc-text">存储数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读取数据"><span class="toc-number">2.2.</span> <span class="toc-text">读取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结-1"><span class="toc-number">2.3.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite"><span class="toc-number">3.</span> <span class="toc-text">SQLite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#新建数据库"><span class="toc-number">3.1.</span> <span class="toc-text">新建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRUD"><span class="toc-number">3.2.</span> <span class="toc-text">CRUD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原生sql语句"><span class="toc-number">3.3.</span> <span class="toc-text">原生sql语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结-2"><span class="toc-number">3.4.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDMS的问题"><span class="toc-number">4.</span> <span class="toc-text">DDMS的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#打开data文件夹是空的？"><span class="toc-number">4.1.</span> <span class="toc-text">打开data文件夹是空的？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件无法导出"><span class="toc-number">4.2.</span> <span class="toc-text">文件无法导出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结-3"><span class="toc-number">5.</span> <span class="toc-text">小结</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>