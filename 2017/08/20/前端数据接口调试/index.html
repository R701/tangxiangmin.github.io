<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/fonts/iconfont.css">
    <!--<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">-->
    <link rel="stylesheet" href="//cdn.bootcss.com/fancybox/3.1.25/jquery.fancybox.min.css">
    <script src="/js/require.js" data-main="/js/main"></script>
</head>
<body>
<div id="blog" class="page page-theme-base" v-cloak>
    <blog-header></blog-header>
    <header class="page_hd" data-v-04342fbc="">
    <div class="container header" data-v-04342fbc="">
        <h1 class="logo" data-v-04342fbc="">
            <a href="/" class="nuxt-link-exact-active nuxt-link-active" data-v-04342fbc="">橙红年代</a>
        </h1>
        <div class="show-md" data-v-04342fbc="">
            <div class="btn-list" data-v-04342fbc="">
                <div class="btn-icon" data-v-04342fbc="">
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                    <span class="btn-line" data-v-04342fbc=""></span>
                </div>
            </div>
        </div>
        <nav class="nav-responsive" data-v-04342fbc="">
            
            <a class="nav_item" href="/">首页</a>
            
            <a class="nav_item" href="/archives">归档</a>
            
            <a class="nav_item" href="/tags">标签</a>
            
            <a class="nav_item" href="/test">Test</a>
            
        </nav>
    </div>
</header>
    <main class="page_mn" >
        <div class="container">
            <article class="article article-detail">
    <header class="text-center">
        <h2 class="article_hd">前端接口调试的几种方式</h2>
        <div class="article_info">
            <span class="hide-sm">发表于</span>
            <span class="show-sm">
                <i class="iconfont icon-archives"></i>
            </span>
            <time>2017/8/20 9:38:22</time>
            |
            <span class="hide-sm">分类于</span>
            <span class="show-sm"><i class="iconfont icon-tag"></i></span>
            
                <a href="/categories/工具" class="hover-highlight">工具</a>
            

        </div>
    </header>
    <div class="article_ct">
        <p>为了与客户端保持一致，公司的web业务采用了前后端分离的形式开发，加之APP内还有一些功能模块采用Webview进行开发，因此调试接口成为了日常必备的工作。这里整理了在工作中用到的接口调试工具和方法。</p>
<a id="more"></a>
<p>主要包括：</p>
<ul>
<li>浏览器控制台的<code>Network</code>面板</li>
<li>Chrome插件<code>Postman</code></li>
<li><code>Fiddler</code>抓包</li>
</ul>
<p>参考：</p>
<ul>
<li><a href="http://blog.csdn.net/u013613428/article/details/51557804" target="_blank" rel="external">最强PostMan使用教程（1）</a></li>
<li><a href="http://www.cnblogs.com/mumublog/articles/6053381.html" target="_blank" rel="external">Android抓包方法(一)之Fiddler代理</a></li>
</ul>
<h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><p><code>Network</code>面板是最早接触也是用的最多的工具，这个板块可以查看资源响应状态，加载时间，评估网页性能等，当然也可以查看网络请求，调试数据接口。</p>
<p>这里只是简单理一下使用步骤，则可以直接进行尝试：</p>
<ul>
<li><code>F12</code>打开控制台，切换到<code>Network</code>面板，可以看见网络请求列表，（如果是第一次打开控制台，列表为空可以刷新一下页面）</li>
<li>选择<code>XHR</code>标签，筛选出<code>Ajax</code>请求</li>
<li>选择一条请求，右侧会展开相关的请求信息面板，包括<code>Headers</code>，<code>Preview</code>等<ul>
<li><code>Headers</code>为经过浏览器格式化后的HTTP报文，可以更直观的获取报文相关信息，也可以点击<code>view source</code>查看原始报文</li>
<li><code>Preview</code>为响应预览，如果返回<code>JSON</code>数据，则可以像在控制台一样展开或折叠数据；貌似还可以直接预览网页（比如后台重定向了个404网页啥的）</li>
</ul>
</li>
</ul>
<p>调试一般分为两步：检查HTTP报文和检查数据格式</p>
<h3 id="报文错误码"><a href="#报文错误码" class="headerlink" title="报文错误码"></a>报文错误码</h3><p>通过查看报文可以很直观的进行接口调试，比如查看缓存，后台约定的自定义<code>Accept</code>头，<code>JWT</code>接口用户验证中的身份校核字段等，所以学习HTTP是一件很划算的事情。当请求报错时，报文的状态码一般都提示了大概的错误理由（请求正确时就直接看数据了谁还管报文啊~）</p>
<ul>
<li><code>404</code>，检查请求路由是正确</li>
<li><code>400</code>，请求参数是否正确，这个错误可能是后台手动抛出的，可以去查下API文档</li>
<li><code>405</code>，请求方法不对，该用GET就别用POST了，也是需要去查看API文档（如果文档就是这么写的就是找后台或者去改他们的代码，只要不怕被打死~）</li>
<li><code>414</code>，一般是GET请求URL太长了</li>
<li><code>500</code>，后台的代码有问题，是不是漏了个分号（PHP/斜眼笑）</li>
<li><code>502</code>，网关错误</li>
</ul>
<p>这里整理的几个常见错误状态码，不仅仅是在Chrome的Network面板下有用，在其他所有的http数据接口调试中都是相通的。了解这些错误码，可以更快的定位错误并修复。</p>
<h3 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h3><p>如果是前后端分离，后端一般会采用JSON格式进行传输，这真是一件让人愉悦的事情。</p>
<p>检查数据格式，一般就是查看数据字段是否是正常（有文档的话会省不少事情），可能后端还会返回一些其他信息，比如处理时间，业务状态码，错误提示信息等，这些就是根据具体的业务进行处理了。</p>
<h3 id="网速限制"><a href="#网速限制" class="headerlink" title="网速限制"></a>网速限制</h3><p>有时候可能需要模拟各种网络环境（比如在网络很慢的情况下出现loading动画），别急，<code>Network</code>面板提供了这个功能哦。</p>
<p>面板右上角有个<code>Offline</code>的复选框，旁边还有一个<code>No throttling</code>的下拉菜单，这个下拉菜单就是用来进行网速限制的，可以模拟<code>2G</code>,<code>3G</code>和<code>WIFI</code>等各种网络环境，是不是十分酷炫~~</p>
<h2 id="Postman"><a href="#Postman" class="headerlink" title="Postman"></a>Postman</h2><p>使用<code>Network</code>面板主要是调试Ajax异步请求的网络接口；在某些时候我们需要在开发之前就确认接口是否运行正常，这是一个比较好的习惯。如果在开发中再发现这些问题，等到后台可能会修复接口的某些参数或者返回值，此时还需要我们去修改前端修改代码，这总是比较危险的。</p>
<p>可以使用<code>Postman</code>来调试数据接口。它是google开发的chrome插件，用来调试HTTP请求，其功能十分强大（UI十分漂亮）。这里有一篇<a href="http://blog.csdn.net/u013613428/article/details/51557804" target="_blank" rel="external">使用教程</a>写的十分详细。</p>
<h3 id="发送请求"><a href="#发送请求" class="headerlink" title="发送请求"></a>发送请求</h3><p>使用Postman发送请求十分简单，</p>
<ul>
<li>选择请求方式，请求方式不同，对应的<code>Request Body</code>也会发生改变（甚至可以模拟文件上传）</li>
</ul>
<ul>
<li>输入接口路径</li>
<li>配置参数，会根据请求方式自动加载已配置的参数</li>
<li>配置请求头，比如<code>Authorization</code>这些，甚至也可以设置<code>Cookie</code>（需要正确的key-value报文格式哦）</li>
</ul>
<p>然后点击<code>send</code>按钮发送请求，然后就可以再<code>body</code>面板中查看对应的数据了。</p>
<p>postman也会自动格式化响应的内容，如果是json，xml或者html，都会整理成适合我们阅读的格式。</p>
<p>另外使用<code>Postman</code>完全不需要考虑跨域的问题，因此也可以进行第三方的接口调试</p>
<h3 id="代码生成"><a href="#代码生成" class="headerlink" title="代码生成"></a>代码生成</h3><p>前面提到，我们可以使用Postman在代码开发之前进行测试，如果测试无误再进行编码。由于在postman上进行测试的时候需要填写一系列配置参数，而在实际编码中如果再写一遍这些参数就比较重复了，因此postman提供了代码生成的功能。</p>
<p>在<code>send</code>按钮的右下角有一个<code>Code</code>的橙色链接，点击即可弹出<code>Generate code snippets</code>面板，左侧有个选择语言的下拉菜单，会根据我们测试的接口自动生成对应语言的接口请求代码，是不是解放双手了~</p>
<p>PS：这个代码生成的功能我并没有用过，因为目前业务需求变化比较大，使用的是<a href="https://www.npmjs.com/package/axios" target="_blank" rel="external">axios</a>框架进行数据请求的。</p>
<h3 id="测试脚本"><a href="#测试脚本" class="headerlink" title="测试脚本"></a>测试脚本</h3><p>另外貌似postman支持测试脚本和变了，不过这个我功能我也没有使用过，先挖个坑把~</p>
<h2 id="Fiddler"><a href="#Fiddler" class="headerlink" title="Fiddler"></a>Fiddler</h2><p>之前在面试的时候有遇见问会不会抓包的，当时还诧异为啥要问前端这个问题，现在才发现，原来抓包也是调试必备的技能之一。</p>
<p>比如最近的业务需求，需要与APP上某个模块的数据保持一致，因此我需要去查询APP的请求接口，然而APP跟网页不同，压根不知道具体的请求路径是啥。后来才了解到，可以使用<a href="http://www.telerik.com/fiddler" target="_blank" rel="external">Fiddler</a>来完成。</p>
<h3 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h3><p>Fiddler类似于代理服务器，会记录当前电脑的所有网络通信，</p>
<ul>
<li><p>Fiddler设置，Tools-&gt; Fiddler Options-&gt;Connections，勾选”Allow remote computers to connect” ，这里还可以设置端口号，Fiddler默认端口号为8888</p>
</li>
<li><p>修改网络代理，一般是手机电脑同时连接局域网，然后修改wifi代理，每种手机可能不尽相同，基本操作是</p>
<ul>
<li>查看电脑在局域网中的ip地址，windows上使用<code>ipconfig</code>查看即可</li>
<li>Android，选择wifi-&gt;显示高级设置-&gt;代理主机名（填写主机IP，及fiddler端口号）</li>
<li>IOS，选择wifi-&gt;HTTP代理-&gt;手动-&gt;IP，端口号</li>
</ul>
</li>
</ul>
<p>然后接下来就可以像在网页上一样操作app了，此时fiddler会拦截所有的请求，右侧面板会显示相关的请求信息，包括报文，返回主体等。除了UI不好看之外，Fiddler的功能还是十分强大的，不过我现在也是边用边摸索而已~</p>
<h3 id="常用功能"><a href="#常用功能" class="headerlink" title="常用功能"></a>常用功能</h3><p><strong>hosts</strong></p>
<p>在开发中有测试服务器和正式服务器之分，通过fiddler内置的Hosts，我们可以快速地在两个服务器之间进行切换，由于会修改请求和响应，APP或H5页面上也会呈现对应的测试数据或真实数据。</p>
<p>打开<code>Tools-&gt;HOSTS</code>即可修改相关的hosts文件，而不必在手动去修改windows目录下原本的hosts文件了。</p>
<p><strong>filters</strong></p>
<p>由于fiddler会显示所有的网络请求，而电脑处于联网时会发送很多请求，这显然不便于我们测试，所幸可以使用<code>filter</code>过滤掉相关的请求。</p>
<p>在右侧<code>filters</code>选项卡下，勾选<code>use Filters</code>，然后定义相关的过滤条件即可。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>由于人手不够，最近也逐渐在写后台的一些东西，相当于提供接口与对接接口的事儿都一个人干了。以前我以为一个人前后全部负责开发沟通成本低，开发效率高，实际上也不是那么理想，自己一个人负责带来的问题就是接口可能会修改的很频繁（因为没有了相关的约束）。</p>
<p>加之还要理解旧代码的业务逻辑，因此接口调试成为了影响工作效率一个很关键的问题，这篇文章也只是简单的记录一下使用方法，连攻略的算不上，留了一些问题待后面再补充回来吧。</p>

    </div>
    <footer class="article_ft">
        
        <a href="/tags/HTTP" class="article_tag">#HTTP</a>
        
        <a href="/tags/调试" class="article_tag">#调试</a>
        
    </footer>

    <div class="article_nav"><a href="/article/mockjs使用心得" class="hover-highlight article_prev">mockjs使用心得</a><a
                href="/article/博客SSR实践总结" class="hover-highlight article_next">博客SSR实践总结</a></div>
</article>
        </div>
    </main>

    <aside>
    <div class="page_sd hide-md">
        <div class="tab">
            <!---->
            
            <ul class="tab_nav">
                <li class="tab_item active" data-target="#J_toc">
                    文章目录
                </li>
                <li class="tab_item" data-target="#J_profile">
                    站点资料
                </li>
            </ul>
            <div class="tab_panel active" id="J_toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Network"><span class="toc-number">1.</span> <span class="toc-text">Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#报文错误码"><span class="toc-number">1.1.</span> <span class="toc-text">报文错误码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据格式"><span class="toc-number">1.2.</span> <span class="toc-text">数据格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网速限制"><span class="toc-number">1.3.</span> <span class="toc-text">网速限制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Postman"><span class="toc-number">2.</span> <span class="toc-text">Postman</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#发送请求"><span class="toc-number">2.1.</span> <span class="toc-text">发送请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码生成"><span class="toc-number">2.2.</span> <span class="toc-text">代码生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试脚本"><span class="toc-number">2.3.</span> <span class="toc-text">测试脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fiddler"><span class="toc-number">3.</span> <span class="toc-text">Fiddler</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用方式"><span class="toc-number">3.1.</span> <span class="toc-text">使用方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用功能"><span class="toc-number">3.2.</span> <span class="toc-text">常用功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">4.</span> <span class="toc-text">小结</span></a></li></ol>
            </div>
            
            <div class="tab_panel " id="J_profile">
                <div>
                    <div class="me">
                        <img src="http://shymean.com/_nuxt/img/head.dd612ee.jpg" alt="shymean" width="100" height="100">
                        <h3>shymean</h3>
                        <p>一个不学无术且无趣的人。</p>
                    </div>
                    <div class="nav-border">
                        <a href="/book" class="nav_item">
                            <i class="iconfont icon-bookshelf"></i>
                            <br>书架
                        </a>
                        <a href="/message" class="nav_item">
                            <i class="iconfont icon-comment"></i>
                            <br>留言
                        </a>
                        <a href="/about" class="nav_item">
                            <i class="iconfont icon-info"></i>
                            <br>关于
                        </a>
                    </div>
                    <div class="contact">
                        <a href="https://github.com/tangxiangmin" target="_blank" class="contact_link">
                            <i class="iconfont icon-github"></i> GitHub</a>
                        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=645234650&amp;site=qq&amp;menu=yes"
                            target="_blank" class="contact_link">
                            <i class="iconfont icon-qq"></i> QQ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tool">
        <div class="btn-list hide-md" id="J_toggleSide">
            <div class="btn-icon">
                <span class="btn-line"></span>
                <span class="btn-line"></span>
                <span class="btn-line"></span>
            </div>
        </div>
        <div class="btn-top">
            <i class="iconfont icon-top"></i>
        </div>
    </div>
</aside>
    <footer class="page_ft">
    <div class="container footer">
        <p>世人的悲欢并不相通，我只是觉得他们吵闹。</p>
        <p>
            Copyright © Shymean 2016 - 2017
            <a href="http://www.miitbeian.gov.cn" rel="nofollow" target="_blank" style="display:inline-block;">粤ICP备17060238号-1</a>
        </p>
    </div>
    <div class="hide-xs">
        <script src="https://s19.cnzz.com/z_stat.php?id=1264491168&amp;web_id=1264491168" language="JavaScript"></script>
    </div>
</footer>

</div>

</body>
</html>